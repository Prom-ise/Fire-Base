<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="bootstrap-5.3.2-dist/css/bootstrap.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

  </head>
  <body>
    <div class="container bg-light shadow-sm p-3 m-5 my-3 text-center">
      <h1 class="text-primary-emphasis">Sign Up Page</h1>
    
    <input type="number" class="bg-tertiary form-control my-4 mx-auto shadow-none w-75" id="phonenumber" placeholder="+234 802 1234 9872"/>
    <button id="sign-in-button" class="btn btn-success w-75" onclick="signP()">Sign In with Phone Number</button>

    <div class="social d-flex gap-4 my-3 mx-auto">
    
      <i onclick="signA()" class="fab fa-google fa-2x"></i>
    
   <i onclick="signB()" class="text-primary fab fa-facebook fa-2x"></i>
    <i onclick="signG()" class="fab fa-github fa-2x"></i>
</div>
     </div>

    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
      import {
        getAuth,
        GoogleAuthProvider,
        signInWithPopup,
        GithubAuthProvider,
        RecaptchaVerifier, signInWithPhoneNumber, FacebookAuthProvider, 
      } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics.js";
      
      const firebaseConfig = {
        apiKey: "AIzaSyAhm0U3zF1xcXOHuhjdU-lHJIjQsX8Nd0M",
        authDomain: "first-class-firebase.firebaseapp.com",
        projectId: "first-class-firebase",
        storageBucket: "first-class-firebase.appspot.com",
        messagingSenderId: "685476076997",
        appId: "1:685476076997:web:2ebc5ec00878085fac3fac",
        measurementId: "G-7ZP960H923",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const analytics = getAnalytics(app);
      const provider = new GoogleAuthProvider();
      const gitHub = new GithubAuthProvider();
      const provide = new FacebookAuthProvider();
      auth.useDeviceLanguage();

        const signA = () => {
        alert("I am Working");
        signInWithPopup(auth, provider)
          .then((result) => {
            const user = result.user;
            console.log(user);
            window.location.href = "dashboard.html";
          })
          .catch((error) => {
            // Handle Errors here.
            const errorCode = error.code;
            const errorMessage = error.message;
            console.log(errorCode);
            console.log(errorMessage);
          });
      };
      window.signA = signA;
      
      const signG = () => {
      signInWithPopup(auth, gitHub)
  .then((result) => {
    const user = result.user;
    console.log(user);
    console.log(user);
  }).catch((error) => {
    const errorCode = error.code;
    const errorMessage = error.message;
    const email = error.customData.email;
    const credential = GithubAuthProvider.credentialFromError(error);
  });
};
 window.signG = signG

      const signP = () => {
            window.recaptchaVerifier = new RecaptchaVerifier(auth, 'sign-in-button', {
                'size': 'invisible',
                'callback': (response) => {
                    console.log(response);
                }
            });

            const appVerifier = window.recaptchaVerifier;
            const phoneNumber = document.getElementById('phonenumber').value
            signInWithPhoneNumber(auth, phoneNumber, appVerifier)
                .then((confirmationResult) => {
                    console.log("msg sent");
                    var verificationCode = prompt('Please enter the verification code sent to your mobile phone:');
                    return confirmationResult.confirm(verificationCode);
                }).then((result)=>{
                    console.log("successfully authenticated", + result);
                }).catch((error) => {
                    console.log("error: " + error);
                });
        }
        window.signP = signP

        const signB = () => {
        alert("I am Working");
        signInWithPopup(auth, provide)
          .then((result) => {
            const user = result.user;
            console.log(user);
          })
          .catch((error) => {
            // Handle Errors here.
            const errorCode = error.code;
            const errorMessage = error.message;
            console.log(errorCode);
            console.log(errorMessage);
          });
      };
      window.signB = signB;
    </script>
  </body>
</html>