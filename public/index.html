<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="bootstrap-5.3.2-dist/css/bootstrap.css">
  </head>
  <body>
    <button class="btn btn-success m-5" onclick="signA()">
      sign in with google
    </button>
    <input type="number" id="phoneNumberInput" />
    <button id="sign-in-button" onclick="signP()">Sign In with Phone Number</button>
    <button onclick="signB()">Sign in with Facebook</button>
    <button onclick="signG()">Sign in with GitHub</button>

    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
      import {
        getAuth,
        GoogleAuthProvider,
        signInWithPopup,
        RecaptchaVerifier, signInWithPhoneNumber, FacebookAuthProvider, GithubAuthProvider, signInWithCredential, signInWithRedirect, getRedirectResult,  
      } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics.js";
      
      const firebaseConfig = {
        apiKey: "AIzaSyAhm0U3zF1xcXOHuhjdU-lHJIjQsX8Nd0M",
        authDomain: "first-class-firebase.firebaseapp.com",
        projectId: "first-class-firebase",
        storageBucket: "first-class-firebase.appspot.com",
        messagingSenderId: "685476076997",
        appId: "1:685476076997:web:2ebc5ec00878085fac3fac",
        measurementId: "G-7ZP960H923",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const analytics = getAnalytics(app);
      const provider = new GoogleAuthProvider();
      const provide = new FacebookAuthProvider();
      const provision = new GithubAuthProvider();
      auth.useDeviceLanguage();

        const signA = () => {
        alert("I am Working");
        signInWithPopup(auth, provider)
          .then((result) => {
            const user = result.user;
            console.log(user);
            window.location.href = "dashboard.html";
          })
          .catch((error) => {
            // Handle Errors here.
            const errorCode = error.code;
            const errorMessage = error.message;
            console.log(errorCode);
            console.log(errorMessage);
          });
      };
      window.signA = signA;
      
      const signP = () => {
            window.recaptchaVerifier = new RecaptchaVerifier(auth, 'sign-in-button', {
                'size': 'invisible',
                'callback': (response) => {
                    console.log(response);
                }
            });

            const appVerifier = window.recaptchaVerifier;
            const phoneNumber = document.getElementById('phoneNumberInput').value
            signInWithPhoneNumber(auth, phoneNumber, appVerifier)
                .then((confirmationResult) => {
                    console.log("msg sent");
                    var verificationCode = prompt('Please enter the verification code sent to your mobile phone:');
                    return confirmationResult.confirm(verificationCode);
                }).then((result)=>{
                    console.log("successfully authenticated", + result);
                }).catch((error) => {
                    console.log("error: " + error);
                });
        }
        window.signP = signP

        const signB = () => {
        alert("I am Working");
        signInWithPopup(auth, provide)
          .then((result) => {
            const user = result.user;
            console.log(user);
          })
          .catch((error) => {
            // Handle Errors here.
            const errorCode = error.code;
            const errorMessage = error.message;
            console.log(errorCode);
            console.log(errorMessage);
          });
      };
      window.signB = signB;

      const signG = () => {
        signInWithRedirect(auth, provision);
        getRedirectResult(auth)
          .then((result) => {
            const credential = GithubAuthProvider.credentialFromResult(result);
            // if (credential) {
            //   // This gives you a GitHub Access Token. You can use it to access the GitHub API.
            //   const token = credential.accessToken;
            //   // ...
            // }
            // The signed-in user info.
            const user = result.user;
          })
          .catch((error) => {
            // Handle Errors here.
            const errorCode = error.code;
            const errorMessage = error.message;
            const credential = GithubAuthProvider.credentialFromError(error);
          });
      };
      window.signG = signG;
    </script>
  </body>
</html>
